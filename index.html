<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bskhomeneeds - All Features Included</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { --amazon-blue: #232f3e; --amazon-orange: #ff9900; --bg: #f3f3f3; --red: #d9534f; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; background: var(--bg); padding-bottom: 80px; }
        header { background: var(--amazon-blue); color: white; padding: 12px; position: sticky; top: 0; z-index: 1000; text-align: center; }
        .page { display: none; padding: 15px; }
        .active-page { display: block !important; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .card { background: white; padding: 12px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); text-align: center; margin-bottom: 10px; }
        .card img { width: 100%; height: 110px; object-fit: contain; background: #fff; }
        .btn-amazon { background: var(--amazon-orange); border: 1px solid #a88734; padding: 10px; width: 100%; border-radius: 5px; font-weight: bold; cursor: pointer; color: #111; }
        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #ddd; z-index: 1000; }
        .nav-item { border: none; background: none; font-size: 11px; font-weight: bold; color: var(--amazon-blue); cursor: pointer; }
        input, select, textarea { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; }
        #status-msg { color: red; font-weight: bold; text-align: center; margin: 10px; font-size: 13px; }
    </style>
</head>
<body>

<header>
    <h2 style="margin:0; color: var(--amazon-orange);">Bskhomeneeds</h2>
</header>

<div id="shop-page" class="page active-page">
    <div id="status-msg"></div>
    <input type="text" id="search" placeholder="üîç Search Products..." onkeyup="filter()" style="width:100%; margin-bottom:15px; padding:10px;">
    <div id="product-grid" class="grid">Loading Products...</div>
</div>

<div id="cart-page" class="page">
    <h3>üõí Shopping Cart</h3>
    <div id="cart-items" class="card">Cart is empty.</div>
    <div id="cart-total" style="font-weight:bold; margin: 15px 0;"></div>
    <div id="order-form" style="display:none;" class="card">
        <input type="text" id="c-name" placeholder="Name">
        <input type="text" id="c-addr" placeholder="Address">
        <button class="btn-amazon" onclick="sendWhatsApp()">Order via WhatsApp</button>
    </div>
    <button id="check-btn" class="btn-amazon" onclick="document.getElementById('order-form').style.display='block'">Proceed to Buy</button>
    <button class="btn-amazon" style="background:#ddd; margin-top:10px;" onclick="show('orders-page')">My History</button>
</div>

<div id="orders-page" class="page">
    <h3>üì¶ Your Past Orders</h3>
    <div id="history-list" class="card">Login to see orders.</div>
    <button onclick="show('shop-page')" class="btn-amazon">Back Home</button>
</div>

<div id="contact-page" class="page">
    <div class="card" style="text-align: left;">
        <h3>üìß Contact Support</h3>
        <p>Email: <b>bskhomeneeds@gmail.com</b></p>
        <hr>
        <div id="login-section">
            <input type="email" id="u-email" placeholder="Enter Gmail">
            <button class="btn-amazon" onclick="login()">Login / Create ID</button>
        </div>
    </div>
</div>

<div id="admin-page" class="page">
    <div class="card" style="text-align: left;">
        <h4>üõ† Admin Panel</h4>
        <input type="text" id="p-name" placeholder="Name *">
        <input type="number" id="p-price" placeholder="Price *">
        <input type="number" id="p-del" placeholder="Delivery Charge (Optional)">
        <textarea id="p-desc" placeholder="Product Details..."></textarea>
        <input type="text" id="p-img" placeholder="Image Link">
        <select id="p-cat">
            <option value="Grocery">Grocery</option>
            <option value="Electronics">Electronics</option>
        </select>
        <button class="btn-amazon" onclick="upload()">List Product</button>
        <button onclick="show('shop-page')" style="width:100%; margin-top:10px; border:none; background:none; color:blue;">Cancel</button>
    </div>
</div>

<nav class="bottom-nav">
    <button class="nav-item" onclick="show('shop-page')">üè†<br>Home</button>
    <button class="nav-item" onclick="show('cart-page')">üõí<br>Cart</button>
    <button class="nav-item" onclick="show('contact-page')">üìß<br>Account</button>
    <button class="nav-item" onclick="adminAuth()">‚öôÔ∏è<br>Admin</button>
</nav>

<script>
    const SB_URL = "https://lfxorgprrgpkkiqdjqdb.supabase.co";
    const SB_KEY = "sb_publishable_yyyMF6aEwhtYh4RHUFrIgA_OEU64IIX";
    const _supabase = supabase.createClient(SB_URL, SB_KEY);

    let items = [], cart = [], user = localStorage.getItem('bsk_user');

    async function load() {
        const grid = document.getElementById('product-grid');
        const status = document.getElementById('status-msg');
        try {
            const { data, error } = await _supabase.from('inventory').select('*');
            if (error) { 
                status.innerText = "Error: " + error.message; 
                return; 
            }
            items = data || [];
            render(items);
        } catch (e) { status.innerText = "Connection issue!"; }
    }

    function render(data) {
        document.getElementById('product-grid').innerHTML = data.map(p => `
            <div class="card">
                <img src="${p.img || 'https://via.placeholder.com/150'}">
                <p><b>${p.Name}</b></p>
                <p style="color:#B12704; font-weight:bold;">‚Çπ${p.price}</p>
                <button class="btn-amazon" style="font-size:10px;" onclick="addCart('${p.Name}', ${p.price})">Add</button>
            </div>
        `).join('') || "No products found.";
    }

    function addCart(n, p) { cart.push({n, p}); alert("Added to cart!"); updateCart(); }
    function updateCart() {
        let t = cart.reduce((s, i) => s + i.p, 0);
        document.getElementById('cart-items').innerHTML = cart.map(i => `<div>${i.n} - ‚Çπ${i.p}</div>`).join('') || "Empty";
        document.getElementById('cart-total').innerText = "Total: ‚Çπ" + t;
    }

    async function upload() {
        const n = document.getElementById('p-name').value, p = document.getElementById('p-price').value;
        const d = document.getElementById('p-del').value, ds = document.getElementById('p-desc').value;
        const i = document.getElementById('p-img').value, c = document.getElementById('p-cat').value;

        if(!n || !p) return alert("Fill Name and Price!");

        const { error } = await _supabase.from('inventory').insert([{ Name: n, price: p, delivery_charge: d || 0, description: ds, img: i, category: c }]);
        if(!error) {
            alert("Listed!");
            // Form Reset (‡§Ø‡§π‡§æ‡§Å ‡§´‡•â‡§∞‡•ç‡§Æ ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ)
            document.getElementById('p-name').value=''; document.getElementById('p-price').value=''; document.getElementById('p-del').value=''; document.getElementById('p-desc').value=''; document.getElementById('p-img').value='';
            load(); 
        } else { alert("Error: " + error.message); }
    }

    function adminAuth() { if(prompt("Password:") === "Bhashkar jyoti Roy") show('admin-page'); }
    function show(id) { document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page')); document.getElementById(id).classList.add('active-page'); }
    function filter() { const q = document.getElementById('search').value.toLowerCase(); render(items.filter(i => i.Name.toLowerCase().includes(q))); }
    function login() { user = document.getElementById('u-email').value; localStorage.setItem('bsk_user', user); location.reload(); }
    function sendWhatsApp() { window.open(`https://wa.me/91XXXXXXXXXX?text=New Order from ${user}`); }

    load();
</script>
</body>
</html>

    
